(this.webpackJsonptruefitvideo=this.webpackJsonptruefitvideo||[]).push([[0],{113:function(e,t,n){e.exports=n(233)},233:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(46),s=n.n(o),i=n(12),u=n(36),c=n(21),l=n(3),m={users:null},p=function(e,t){return Object(l.a)({},e,{users:t.users})},d=function(e,t){return Object(l.a)({},e,{users:Object(l.a)({},e.users,Object(c.a)({},t.uid,t.user))})};var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USERS_SET":return p(e,t);case"USER_SET":return d(e,t);default:return e}},f={authUser:null},b=function(e,t){return Object(l.a)({},e,{authUser:t.authUser})};var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_USER_SET":return b(e,t);default:return e}},v={messages:null,limit:5},g=function(e,t){return Object(l.a)({},e,{messages:t.messages})},O=function(e,t){return Object(l.a)({},e,{limit:t.limit})};var j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MESSAGES_SET":return g(e,t);case"MESSAGES_LIMIT_SET":return O(e,t);default:return e}},S=Object(u.b)({sessionState:E,userState:h,messageState:j}),y=Object(u.c)(S,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),w=n(24),U=n(27),k=n(25);function x(){var e=Object(w.a)(['\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  @import url("https://fonts.googleapis.com/css?family=Montserrat|Roboto");\n\n  body {\n    color: #c5986a;\n    font-family: Montserrat, sans-serif;\n    overflow-x:hidden;\n  }\n\n\n']);return x=function(){return e},e}var C=Object(k.a)(x()),M=n(22),T=n(16),V=function(){return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 186 44.227"},r.a.createElement("path",{d:"M88.413.413,88.207,0l-.413.207L66.713,8.68,45.427.207,45.22,0l-.207.413-.207.62-.207.413h.413L65.887,9.92V21.7L52.247,43.193l-.207.207.413.207.62.413.207.207.207-.413L66.713,23.147l13.02,20.667.207.413.413-.207.413-.413.413-.207-.207-.207L67.333,21.7V9.92l21.08-8.473h.413l-.207-.413Z",transform:"translate(47.573)"}),r.a.createElement("path",{d:"M.413,5.3H0V6.747H7.647v21.7H9.093V6.747H16.74V5.3H.413Z",transform:"translate(0 5.653)"}),r.a.createElement("path",{d:"M21.473,20.387a7.192,7.192,0,0,0,5.58-7.44c0-4.96-3.307-7.647-8.887-7.647H9.9V28.447h1.447V20.8H17.96a5.722,5.722,0,0,0,1.86-.207L25.4,28.24l.207.207h1.86l-.413-.62ZM11.347,6.747H17.96c4.753,0,7.44,2.273,7.44,6.2,0,4.133-2.687,6.407-7.44,6.407H11.347V6.747Z",transform:"translate(10.56 5.653)"}),r.a.createElement("path",{d:"M38.367,5.3h-.413V18.94c0,5.167-2.893,8.06-7.853,8.06s-7.853-2.893-7.853-8.06V5.3H20.8V18.94c0,5.993,3.307,9.507,9.3,9.507s9.3-3.513,9.3-9.507V5.3H38.367Z",transform:"translate(22.187 5.653)"}),r.a.createElement("path",{d:"M34.547,27V17.287h11.78V15.84H34.547V6.747H47.773V5.3H33.1V28.447H48.393V27H34.547Z",transform:"translate(35.307 5.653)"}),r.a.createElement("path",{d:"M71.313,5.3H70.9V28.447h1.447V18.113H83.3V16.667H72.347V6.747h12.4V5.3H71.313Z",transform:"translate(75.627 5.653)"}),r.a.createElement("path",{d:"M79.713,5.3H79.3V28.447h1.653V5.3h-1.24Z",transform:"translate(84.587 5.653)"}),r.a.createElement("path",{d:"M98.333,5.3H81.8V6.747h7.853v21.7H91.1V6.747h7.647V5.3Z",transform:"translate(87.253 5.653)"}))},A=n(5),P=n(38),R=n.n(P),I=(n(122),n(124),{apiKey:"AIzaSyCYBIAZV-Uea3MB62kyhnGr90y5F6AhzjY",authDomain:"truefitvideo.firebaseapp.com",databaseURL:"https://truefitvideo.firebaseio.com",projectId:"truefitvideo",storageBucket:"truefitvideo.appspot.com",messagingSenderId:"396071631932",appId:"1:396071631932:web:28667b8b87cc87f0e29739",measurementId:"G-JPF2ZN5BJP"}),D=function e(){var t=this;Object(A.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,n){return t.auth.createUserWithEmailAndPassword(e,n)},this.doSignInWithEmailAndPassword=function(e,n){return t.auth.signInWithEmailAndPassword(e,n)},this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doSendEmailVerification=function(){return t.auth.currentUser.sendEmailVerification({url:"http://localhost:3000"})},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},this.onAuthUserListener=function(e,n){return t.auth.onAuthStateChanged((function(a){a?t.user(a.uid).once("value").then((function(t){var n=t.val();n.roles||(n.roles={}),a=Object(l.a)({uid:a.uid,email:a.email,emailVerified:a.emailVerified,providerData:a.providerData},n),e(a)})):n()}))},this.user=function(e){return t.db.ref("users/".concat(e))},this.users=function(){return t.db.ref("users")},this.message=function(e){return t.db.ref("messages/".concat(e))},this.messages=function(){return t.db.ref("messages")},R.a.initializeApp(I),this.serverValue=R.a.database.ServerValue,this.emailAuthProvider=R.a.auth.EmailAuthProvider,this.auth=R.a.auth(),this.db=R.a.database()},H=r.a.createContext(null),N=function(e){return function(t){return r.a.createElement(H.Consumer,null,(function(n){return r.a.createElement(e,Object.assign({},t,{firebase:n}))}))}},_=H,L=D,W=N((function(e){var t=e.firebase;return r.a.createElement("button",{type:"button",onClick:t.doSignOut},"Sign Out")}));function Z(){var e=Object(w.a)(["\n  width: 100vw;\n  height: 100%;\n  background-color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0px;\n  box-shadow: 0px -10px 20px black;\n  overflow: hidden;\n\n  ul {\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n\n    li {\n      margin: 0 10px 0 10px;\n    }\n  }\n\n  svg {\n    height: 50px;\n    width: 200px;\n\n    path {\n      fill: #c5986a;\n    }\n  }\n"]);return Z=function(){return e},e}function z(){var e=Object(w.a)(["\n  position: absolute;\n  top: 5%;\n  left: 2rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  width: 2rem;\n  height: 2rem;\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  padding: 0;\n  z-index: 10;\n\n  &:focus {\n    outline: none;\n  }\n\n  div {\n    width: 2rem;\n    height: 0.25rem;\n    background: #c5986a;\n    border-radius: 10px;\n    transition: all 0.3s linear;\n    position: relative;\n    transform-origin: 1px;\n\n    :first-child {\n      transform: ",";\n    }\n\n    :nth-child(2) {\n      opacity: ",";\n      transform: ",";\n    }\n\n    :nth-child(3) {\n      transform: ",";\n    }\n  }\n"]);return z=function(){return e},e}function F(){var e=Object(w.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  background: #effffa;\n  transform: ",";\n  height: 100vh;\n  text-align: left;\n  padding: 2rem;\n  position: absolute;\n  top: 0;\n  left: 0;\n  transition: transform 0.3s ease-in-out;\n\n  @media (max-width: 576px) {\n    width: 100%;\n  }\n\n  a {\n    font-size: 2rem;\n    text-transform: uppercase;\n    padding: 2rem 0;\n    font-weight: bold;\n    letter-spacing: 0.5rem;\n    color: #0d0c1d;\n    text-decoration: none;\n    transition: color 0.3s linear;\n\n    @media (max-width: 576px) {\n      font-size: 1.5rem;\n      text-align: center;\n    }\n\n    &:hover {\n      color: #343078;\n    }\n  }\n"]);return F=function(){return e},e}var J=k.b.nav(F(),(function(e){return e.open?"translateX(0)":"translateX(-100%)"})),X=k.b.button(z(),(function(e){return e.open?"rotate(45deg)":"rotate(0)"}),(function(e){return e.open?"0":"1"}),(function(e){return e.open?"translateX(20px)":"translateX(0)"}),(function(e){return e.open?"rotate(-45deg)":"rotate(0)"})),B=k.b.header(Z()),G=function(e){var t=e.open,n=e.authUser;return r.a.createElement(J,{open:t},r.a.createElement(K,{authUser:n}))},Y=function(e){var t=e.open,n=e.setOpen;return r.a.createElement(X,{open:t,onClick:function(){return n(!t)}},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))},K=function(e){var t=e.authUser;return r.a.createElement("div",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(T.a,{to:"/home"},"Home")),r.a.createElement("li",null,r.a.createElement(T.a,{to:"/account"},"Account")),!!t.roles.ADMIN&&r.a.createElement("li",null,r.a.createElement(T.a,{to:"/admin"},"Admin"))))},q=function(){return r.a.createElement("ul",null,r.a.createElement(T.a,{to:"/"},r.a.createElement(V,null)),r.a.createElement("li",null,r.a.createElement(T.a,{to:"/signin"},"Sign In")))},Q=Object(i.b)((function(e){return{authUser:e.sessionState.authUser}}))((function(e){var t=e.authUser,n=r.a.useState(!1),a=Object(M.a)(n,2),o=a[0],s=a[1],i=r.a.useRef();return t?r.a.createElement(B,null,r.a.createElement("div",{ref:i},r.a.createElement(Y,{open:o,setOpen:s}),r.a.createElement(G,{open:o,setOpen:s,authUser:t})),r.a.createElement(T.a,{to:"/"},r.a.createElement(V,null)),r.a.createElement(W,null)):r.a.createElement(B,null,r.a.createElement(q,null))})),$=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Landing"))},ee=n(6),te=n(8),ne=n(7),ae=n(9),re={username:"",email:"",passwordOne:"",passwordTwo:"",error:null},oe=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onSubmit=function(e){var t=n.state,a=t.username,r=t.email,o=t.passwordOne;n.props.firebase.doCreateUserWithEmailAndPassword(r,o).then((function(e){return n.props.firebase.user(e.user.uid).set({username:a,email:r})})).then((function(){return n.props.firebase.doSendEmailVerification()})).then((function(){n.setState(Object(l.a)({},re)),n.props.history.push("/home")})).catch((function(e){"auth/email-already-in-use"===e.code&&(e.message="\n  An account with this E-Mail address already exists.\n  Try to login with this account instead. If you think the\n  account is already used from one of the social logins, try\n  to sign in with one of them. Afterward, associate your accounts\n  on your personal account page.\n"),n.setState({error:e})})),e.preventDefault()},n.onChange=function(e){n.setState(Object(c.a)({},e.target.name,e.target.value))},n.state=Object(l.a)({},re),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.email,a=e.passwordOne,o=e.passwordTwo,s=e.error,i=a!==o||""===a||""===n||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"}),r.a.createElement("input",{name:"email",value:n,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("input",{name:"passwordOne",value:a,onChange:this.onChange,type:"password",placeholder:"Password"}),r.a.createElement("input",{name:"passwordTwo",value:o,onChange:this.onChange,type:"password",placeholder:"Confirm Password"}),r.a.createElement("button",{disabled:i,type:"submit"},"Sign Up"),s&&r.a.createElement("p",null,s.message))}}]),t}(a.Component),se=function(){return r.a.createElement("p",null,"Don't have an account? ",r.a.createElement(T.a,{to:"/signup"},"Sign Up"))},ie=Object(U.f)(N(oe)),ue=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"SignUp"),r.a.createElement(ie,null))},ce=n(13),le={email:"",error:null},me=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onSubmit=function(e){var t=n.state.email;n.props.firebase.doPasswordReset(t).then((function(){n.setState(Object(l.a)({},le))})).catch((function(e){n.setState({error:e})})),e.preventDefault()},n.onChange=function(e){n.setState(Object(c.a)({},e.target.name,e.target.value))},n.state=Object(l.a)({},le),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.error,a=""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"email",value:this.state.email,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("button",{disabled:a,type:"submit"},"Reset My Password"),n&&r.a.createElement("p",null,n.message))}}]),t}(a.Component),pe=function(){return r.a.createElement("p",null,r.a.createElement(T.a,{to:"/pw-forget"},"Forgot Password?"))},de=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"PasswordForget"),r.a.createElement(he,null))},he=N(me),fe={email:"",password:"",error:null},be=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onSubmit=function(e){var t=n.state,a=t.email,r=t.password;n.props.firebase.doSignInWithEmailAndPassword(a,r).then((function(){n.setState(Object(l.a)({},fe)),n.props.history.push("/home")})).catch((function(e){n.setState({error:e})})),e.preventDefault()},n.onChange=function(e){n.setState(Object(c.a)({},e.target.name,e.target.value))},n.state=Object(l.a)({},fe),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=e.error,o=""===n||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"email",value:t,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("input",{name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"}),r.a.createElement("button",{disabled:o,type:"submit"},"Sign In"),a&&r.a.createElement("p",null,a.message))}}]),t}(a.Component),Ee=Object(ce.a)(U.f,N)(be),ve=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"SignIn"),r.a.createElement(Ee,null),r.a.createElement(pe,null),r.a.createElement(se,null))},ge=n(37),Oe=n.n(ge),je=n(47),Se=n(41),ye=n(110),we=n.n(ye),Ue=function(e){var t=e.participant,n=Object(a.useState)([]),o=Object(M.a)(n,2),s=o[0],i=o[1],u=Object(a.useState)([]),c=Object(M.a)(u,2),l=c[0],m=c[1],p=Object(a.useRef)(),d=Object(a.useRef)(),h=function(e){return Array.from(e.values()).map((function(e){return e.track})).filter((function(e){return null!==e}))};return Object(a.useEffect)((function(){i(h(t.videoTracks)),m(h(t.audioTracks));return t.on("trackSubscribed",(function(e){"video"===e.kind?i((function(t){return[].concat(Object(Se.a)(t),[e])})):m((function(t){return[].concat(Object(Se.a)(t),[e])}))})),t.on("trackUnsubscribed",(function(e){"video"===e.kind?i((function(t){return t.filter((function(t){return t!==e}))})):m((function(t){return t.filter((function(t){return t!==e}))}))})),function(){i([]),m([]),t.removeAllListeners()}}),[t]),Object(a.useEffect)((function(){var e=s[0];if(e)return e.attach(p.current),function(){e.detach()}}),[s]),Object(a.useEffect)((function(){var e=l[0];if(e)return e.attach(d.current),function(){e.detach()}}),[l]),r.a.createElement("div",{className:"participant"},r.a.createElement("h3",null,t.identity),r.a.createElement("video",{ref:p,autoPlay:!0}),r.a.createElement("audio",{ref:d,autoPlay:!0,muted:!0}))},ke=function(e){var t=e.roomName,n=e.token,o=Object(a.useState)(null),s=Object(M.a)(o,2),i=s[0],u=s[1],c=Object(a.useState)([]),l=Object(M.a)(c,2),m=l[0],p=l[1];Object(a.useEffect)((function(){var e=function(e){p((function(t){return[].concat(Object(Se.a)(t),[e])}))},a=function(e){p((function(t){return t.filter((function(t){return t!==e}))}))};return we.a.connect(n,{name:t}).then((function(t){u(t),t.on("participantConnected",e),t.on("participantDisconnected",a),t.participants.forEach(e)})),function(){u((function(e){return e&&"connected"===e.localParticipant.state?(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect(),null):e}))}}),[t,n]);var d=m.map((function(e){return r.a.createElement(Ue,{key:e.sid,participant:e})}));return r.a.createElement("div",{className:"room"},r.a.createElement("h2",null,"Room: ",t),r.a.createElement("div",{className:"local-participant"},i?r.a.createElement(Ue,{key:i.localParticipant.sid,participant:i.localParticipant}):""),r.a.createElement("h3",null,"Remote Participants"),r.a.createElement("div",{className:"remote-participants"},d))},xe=function(e){var t=function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(te.a)(this,Object(ne.a)(n).call(this,e))).props.onSetAuthUser(JSON.parse(localStorage.getItem("authUser"))),t}return Object(ae.a)(n,t),Object(ee.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.listener=this.props.firebase.onAuthUserListener((function(t){localStorage.setItem("authUser",JSON.stringify(t)),e.props.onSetAuthUser(t)}),(function(){localStorage.removeItem("authUser"),e.props.onSetAuthUser(null)}))}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){return r.a.createElement(e,this.props)}}]),n}(r.a.Component);return Object(ce.a)(N,Object(i.b)(null,(function(e){return{onSetAuthUser:function(t){return e({type:"AUTH_USER_SET",authUser:t})}}})))(t)},Ce=function(e){return function(t){var n=function(n){function a(){return Object(A.a)(this,a),Object(te.a)(this,Object(ne.a)(a).apply(this,arguments))}return Object(ae.a)(a,n),Object(ee.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.listener=this.props.firebase.onAuthUserListener((function(n){e(n)||t.props.history.push("/signin")}),(function(){return t.props.history.push("/signin")}))}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){return e(this.props.authUser)?r.a.createElement(t,this.props):null}}]),a}(r.a.Component);return Object(ce.a)(U.f,N,Object(i.b)((function(e){return{authUser:e.sessionState.authUser}})))(n)}},Me=function(e){var t=function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(te.a)(this,Object(ne.a)(n).call(this,e))).onSendEmailVerification=function(){t.props.firebase.doSendEmailVerification().then((function(){return t.setState({isSent:!0})}))},t.state={isSent:!1},t}return Object(ae.a)(n,t),Object(ee.a)(n,[{key:"render",value:function(){return(t=this.props.authUser)&&!t.emailVerified&&t.providerData.map((function(e){return e.providerId})).includes("password")?r.a.createElement("div",null,this.state.isSent?r.a.createElement("p",null,"E-Mail confirmation sent: Check you E-Mails (Spam folder included) for a confirmation E-Mail. Refresh this page once you confirmed your E-Mail."):r.a.createElement("p",null,"Verify your E-Mail: Check you E-Mails (Spam folder included) for a confirmation E-Mail or send another confirmation E-Mail."),r.a.createElement("button",{type:"button",onClick:this.onSendEmailVerification,disabled:this.state.isSent},"Send confirmation E-Mail")):r.a.createElement(e,this.props);var t}}]),n}(r.a.Component);return Object(ce.a)(N,Object(i.b)((function(e){return{authUser:e.sessionState.authUser}})))(t)},Te=n(111),Ve=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onToggleEditMode=function(){n.setState((function(e){return{editMode:!e.editMode,editText:n.props.message.text}}))},n.onChangeEditText=function(e){n.setState({editText:e.target.value})},n.onSaveEditText=function(){n.props.onEditMessage(n.props.message,n.state.editText),n.setState({editMode:!1})},n.state={editMode:!1,editText:n.props.message.text},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.props,t=e.authUser,n=e.message,a=e.onRemoveMessage,o=this.state,s=o.editMode,i=o.editText;return r.a.createElement("li",null,s?r.a.createElement("input",{type:"text",value:i,onChange:this.onChangeEditText}):r.a.createElement("span",null,r.a.createElement("strong",null,n.userId)," ",n.text,n.editedAt&&r.a.createElement("span",null,"(Edited)")),t.uid===n.userId&&r.a.createElement("span",null,s?r.a.createElement("span",null,r.a.createElement("button",{onClick:this.onSaveEditText},"Save"),r.a.createElement("button",{onClick:this.onToggleEditMode},"Reset")):r.a.createElement("button",{onClick:this.onToggleEditMode},"Edit"),!s&&r.a.createElement("button",{type:"button",onClick:function(){return a(n.uid)}},"Delete")))}}]),t}(a.Component),Ae=function(e){var t=e.authUser,n=e.messages,a=e.onEditMessage,o=e.onRemoveMessage;return r.a.createElement("ul",null,n.map((function(e){return r.a.createElement(Ve,{authUser:t,key:e.uid,message:e,onEditMessage:a,onRemoveMessage:o})})))},Pe=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onListenForMessages=function(){n.props.firebase.messages().orderByChild("createdAt").limitToLast(n.props.limit).on("value",(function(e){n.props.onSetMessages(e.val()),n.setState({loading:!1})}))},n.onChangeText=function(e){n.setState({text:e.target.value})},n.onCreateMessage=function(e,t){n.props.firebase.messages().push({text:n.state.text,userId:t.uid,createdAt:n.props.firebase.serverValue.TIMESTAMP}),n.setState({text:""}),e.preventDefault()},n.onEditMessage=function(e,t){e.uid;var a=Object(Te.a)(e,["uid"]);n.props.firebase.message(e.uid).set(Object(l.a)({},a,{text:t,editedAt:n.props.firebase.serverValue.TIMESTAMP}))},n.onRemoveMessage=function(e){n.props.firebase.message(e).remove()},n.onNextPage=function(){n.props.onSetMessagesLimit(n.props.limit+5)},n.state={text:"",loading:!1},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidMount",value:function(){this.props.messages.length||this.setState({loading:!0}),this.onListenForMessages()}},{key:"componentDidUpdate",value:function(e){e.limit!==this.props.limit&&this.onListenForMessages()}},{key:"componentWillUnmount",value:function(){this.props.firebase.messages().off()}},{key:"render",value:function(){var e=this,t=this.props.messages,n=this.state,a=n.text,o=n.loading;return r.a.createElement("div",null,!o&&t&&r.a.createElement("button",{type:"button",onClick:this.onNextPage},"More"),o&&r.a.createElement("div",null,"Loading ..."),t&&r.a.createElement(Ae,{authUser:this.props.authUser,messages:t,onEditMessage:this.onEditMessage,onRemoveMessage:this.onRemoveMessage}),!t&&r.a.createElement("div",null,"There are no messages ..."),r.a.createElement("form",{onSubmit:function(t){return e.onCreateMessage(t,e.props.authUser)}},r.a.createElement("input",{type:"text",value:a,onChange:this.onChangeText}),r.a.createElement("button",{type:"submit"},"Send")))}}]),t}(a.Component),Re=Object(ce.a)(N,Object(i.b)((function(e){return{authUser:e.sessionState.authUser,messages:Object.keys(e.messageState.messages||{}).map((function(t){return Object(l.a)({},e.messageState.messages[t],{uid:t})})),limit:e.messageState.limit}}),(function(e){return{onSetMessages:function(t){return e({type:"MESSAGES_SET",messages:t})},onSetMessagesLimit:function(t){return e({type:"MESSAGES_LIMIT_SET",limit:t})}}})))(Pe),Ie=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).openVideoChat=function(){n.setState({roomOpen:!0})},n.renderVideoChat=function(){if(n.state.token)return r.a.createElement("button",{onClick:n.openVideoChat},"VideoChat")},n.state={token:"",room:"",roomOpen:!1},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.user(this.props.authUser.uid).once("value",(function(t){e.setState({token:t.val().token,room:t.val().roomName})}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Home Page"),this.renderVideoChat(),r.a.createElement("p",null,"The Home Page is accessible by every signed in user."),this.state.roomOpen?r.a.createElement(ke,{roomName:this.state.room,token:this.state.token}):r.a.createElement("div",null,r.a.createElement("h2",null,"Video Room not open")),r.a.createElement(Re,null))}}]),t}(r.a.Component),De=Object(ce.a)(Object(i.b)((function(e){return{authUser:e.sessionState.authUser}})),N,Me,Ce((function(e){return!!e})))(Ie),He={passwordOne:"",passwordTwo:"",error:null},Ne=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onSubmit=function(e){var t=n.state.passwordOne;n.props.firebase.doPasswordUpdate(t).then((function(){n.setState(Object(l.a)({},He))})).catch((function(e){n.setState({error:e})})),e.preventDefault()},n.onChange=function(e){n.setState(Object(c.a)({},e.target.name,e.target.value))},n.state=Object(l.a)({},He),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.state,t=e.passwordOne,n=e.passwordTwo,a=e.error,o=t!==n||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"passwordOne",value:t,onChange:this.onChange,type:"password",placeholder:"New Password"}),r.a.createElement("input",{name:"passwordTwo",value:n,onChange:this.onChange,type:"password",placeholder:"Confirm New Password"}),r.a.createElement("button",{disabled:o,type:"submit"},"Reset My Password"),a&&r.a.createElement("p",null,a.message))}}]),t}(a.Component),_e=N(Ne),Le=Object(ce.a)(Object(i.b)((function(e){return{authUser:e.sessionState.authUser}})),Me,Ce((function(e){return!!e})))((function(e){var t=e.authUser;return r.a.createElement("div",null,r.a.createElement("h1",null,"Account: ",t.email),r.a.createElement(_e,null))})),We=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).state={loading:!1},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.users.length||this.setState({loading:!0}),this.props.firebase.users().on("value",(function(t){e.props.onSetUsers(t.val()),e.setState({loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.props.firebase.users().off()}},{key:"render",value:function(){var e=this.props.users,t=this.state.loading;return r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),t&&r.a.createElement("div",null,"Loading ..."),r.a.createElement("ul",null,e.map((function(e){return r.a.createElement("li",{key:e.uid},r.a.createElement("span",null,r.a.createElement("strong",null,"ID:")," ",e.uid),r.a.createElement("span",null,r.a.createElement("strong",null,"E-Mail:")," ",e.email),r.a.createElement("span",null,r.a.createElement("strong",null,"Name:")," ",e.username),r.a.createElement("span",null,r.a.createElement(T.a,{to:"".concat("/admin","/").concat(e.uid)},"Details")))}))))}}]),t}(a.Component),Ze=Object(ce.a)(N,Object(i.b)((function(e){return{users:Object.keys(e.userState.users||{}).map((function(t){return Object(l.a)({},e.userState.users[t],{uid:t})}))}}),(function(e){return{onSetUsers:function(t){return e({type:"USERS_SET",users:t})}}})))(We),ze=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).onSendPasswordResetEmail=function(){n.props.firebase.doPasswordReset(n.props.user.email)},n.onCreateRoom=function(){var e=Object(je.a)(Oe.a.mark((function e(t){var a,r;return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("/video/token",{method:"POST",body:JSON.stringify({identity:n.props.user.username.split(" ").join(""),room:n.props.user.username}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 3:return a=e.sent,n.props.firebase.user(n.props.match.params.id).set(Object(l.a)({},n.props.user,{token:a.token,roomName:n.props.user.username})),e.next=7,fetch("/video/token",{method:"POST",body:JSON.stringify({identity:n.props.authUser.username.split(" ").join(""),room:n.props.user.username}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 7:r=e.sent,n.props.firebase.user(n.props.authUser.uid).set(Object(l.a)({},n.props.user,{token:r.token,roomName:n.props.user.username}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={loading:!1,token:""},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.user||this.setState({loading:!0}),this.props.firebase.user(this.props.match.params.id).on("value",(function(t){e.props.onSetUser(t.val(),e.props.match.params.id),e.setState({loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.props.firebase.user(this.props.match.params.id).off()}},{key:"render",value:function(){var e=this.props.user,t=this.state.loading;return r.a.createElement("div",null,r.a.createElement("h2",null,"User (",this.props.match.params.id,")"),t&&r.a.createElement("div",null,"Loading ..."),e&&r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement("strong",null,"ID:")," ",e.uid),r.a.createElement("span",null,r.a.createElement("strong",null,"E-Mail:")," ",e.email),r.a.createElement("span",null,r.a.createElement("strong",null,"Username:")," ",e.username),r.a.createElement("span",null,r.a.createElement("button",{type:"button",onClick:this.onSendPasswordResetEmail},"Passwort zur\xfccksetzen"),r.a.createElement("button",{type:"button",onClick:this.onCreateRoom},"VideoChat starten"))))}}]),t}(a.Component),Fe=Object(ce.a)(N,Object(i.b)((function(e,t){return{user:(e.userState.users||{})[t.match.params.id],authUser:e.sessionState.authUser}}),(function(e){return{onSetUser:function(t,n){return e({type:"USER_SET",user:t,uid:n})}}})))(ze),Je=Object(ce.a)(Me,Ce((function(e){return e&&!!e.roles.ADMIN})))((function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Admin"),r.a.createElement("p",null,"The Admin Page is accessible by every signed in admin user."),r.a.createElement(U.c,null,r.a.createElement(U.a,{exact:!0,path:"/admin/:id",component:Fe}),r.a.createElement(U.a,{exact:!0,path:"/admin",component:Ze})))})),Xe=n(18),Be=Object(Xe.a)();function Ge(){var e=Object(w.a)(["\n  display: flex;\n  width: 100vw;\n  height: 100%;\n  margin-top: 150px;\n  justify-content: center;\n"]);return Ge=function(){return e},e}function Ye(){var e=Object(w.a)(["\n  display: flex;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 70px;\n"]);return Ye=function(){return e},e}function Ke(){var e=Object(w.a)(["\n  display: flex;\n  width: 100vw;\n  height: 100vh;\n"]);return Ke=function(){return e},e}var qe=k.b.div(Ke()),Qe=k.b.div(Ye()),$e=k.b.div(Ge()),et=xe((function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(U.b,{history:Be},r.a.createElement(C,null),r.a.createElement(qe,null,r.a.createElement(Qe,null,r.a.createElement(Q,null)),r.a.createElement($e,null,r.a.createElement(U.c,null,r.a.createElement(U.a,{exact:!0,path:"/",component:$}),r.a.createElement(U.a,{path:"/signup",component:ue}),r.a.createElement(U.a,{path:"/signin",component:ve}),r.a.createElement(U.a,{path:"/pw-forget",component:de}),r.a.createElement(U.a,{path:"/home",component:De}),r.a.createElement(U.a,{path:"/account",component:Le}),r.a.createElement(U.a,{path:"/admin",component:Je}))))))}));s.a.render(r.a.createElement(i.a,{store:y},r.a.createElement(_.Provider,{value:new L},r.a.createElement(et,null))),document.getElementById("root"))}},[[113,1,2]]]);
//# sourceMappingURL=main.e33858c4.chunk.js.map